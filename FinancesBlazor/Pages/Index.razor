@page "/"
@using FinancesBlazor.Components.Grid;
@using System.Text.Json.Nodes;
@using FinancesBlazor.ViewManager;
@inject ViewManager _viewManager;
@implements IDisposable

<PageTitle>@_viewManager.ActiveView.Title</PageTitle>
<FinancesBlazor.Components.Grid.Grid View="@_viewManager.ActiveView" @key=gridId />

@code{
    private Guid gridId = Guid.NewGuid();


    protected override void OnInitialized()
    {
        _viewManager.ViewChanged += ViewChanged;
    }

    void ViewChanged(object? sender, View e)
    {
        if (e != _viewManager.ActiveView)
            return;
        gridId = Guid.NewGuid();
        StateHasChanged();
    }

    void IDisposable.Dispose()
    {
        _viewManager.ViewChanged -= ViewChanged;
    }
}