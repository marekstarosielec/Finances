@page "/"
@using FinancesBlazor.Components.Grid;
@using System.Text.Json.Nodes;
@inject DataViewManager _dataViewManager;
@implements IDisposable

<PageTitle>@_dataViewManager.ActiveView.Title</PageTitle>
<FinancesBlazor.Components.Grid.Grid @key=gridId DataView="_dataViewManager.ActiveView" />

@code{
    private Guid gridId = Guid.NewGuid();


    protected override void OnInitialized()
    {
        _dataViewManager.ActiveViewChanged += ActiveDataViewChanged;
    }

    void ActiveDataViewChanged(object? sender, DataView.DataView e)
    {
        if (e != _dataViewManager.ActiveView)
            return;
        gridId = Guid.NewGuid();
        StateHasChanged();
    }

    void IDisposable.Dispose()
    {
       _dataViewManager.ActiveViewChanged -= ActiveDataViewChanged;
    }
}